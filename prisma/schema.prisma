// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id            String   @id @default(cuid())
    email         String   @unique
    name          String?
    emailVerified Boolean
    image         String?
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt

    sessions Session[]
    accounts Account[]

    // Custom relations
    scans   ScanResult[]
    apiKeys ApiKey[]
}

model Session {
    id        String   @id
    userId    String
    expiresAt DateTime
    ipAddress String?
    userAgent String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Account {
    id           String    @id
    userId       String
    accountId    String
    providerId   String
    accessToken  String?
    refreshToken String?
    expiresAt    DateTime?
    password     String?
    createdAt    DateTime  @default(now())
    updatedAt    DateTime  @updatedAt

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Verification {
    id         String   @id
    identifier String
    value      String
    expiresAt  DateTime
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
}

model ScanResult {
    id        String   @id @default(cuid())
    type      String // e.g., "PASSWORD", "LEAK", "IP", "PHISHING"
    score     Int
    details   Json?
    createdAt DateTime @default(now())

    userId String?
    user   User?   @relation(fields: [userId], references: [id])
}

model ApiKey {
    id        String   @id @default(cuid())
    key       String   @unique
    name      String?
    isActive  Boolean  @default(true)
    createdAt DateTime @default(now())

    userId String
    user   User   @relation(fields: [userId], references: [id])
}
